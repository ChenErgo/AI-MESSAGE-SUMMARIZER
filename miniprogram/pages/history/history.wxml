<view class="container">
  <!-- ç»Ÿè®¡ä¿¡æ¯ -->
  <view class="stats" wx:if="{{total > 0}}">
    <text class="stats-text">å…± {{total}} æ¡è®°å½•</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty" wx:if="{{list.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">æš‚æ— å†å²è®°å½•</text>
    <view class="empty-action" bindtap="onBackToHome">
      <text>å»ç”Ÿæˆæ€»ç»“</text>
    </view>
  </view>

  <!-- åˆ—è¡¨ -->
  <view class="list" wx:else>
    <view
      class="item"
      wx:for="{{list}}"
      wx:key="_id"
      bindtap="onViewDetail"
      data-id="{{item._id}}"
    >
      <view class="item-header">
        <view class="scene-tag">
          <text>{{util.getSceneName(item.scene)}}</text>
        </view>
        <text class="time">{{util.formatRelativeTime(item.created_at)}}</text>
      </view>

      <!-- æ€»ç»“è¦ç‚¹ -->
      <view class="item-content" wx:if="{{item.output_json && item.output_json.summary_points}}">
        <view class="summary-points">
          <text class="point" wx:for="{{item.output_json.summary_points}}" wx:for-item="point" wx:for-index="pointIndex" wx:key="pointIndex">
            â€¢ {{point}}
          </text>
        </view>
      </view>

      <!-- å¾…åŠäº‹é¡¹ -->
      <view class="item-content" wx:if="{{item.output_json && item.output_json.todos && item.output_json.todos.length > 0}}">
        <view class="todo-preview">
          <text class="todo-icon">ğŸ“‹</text>
          <text class="todo-count">{{item.output_json.todos.length}} ä¸ªå¾…åŠ</text>
        </view>
      </view>

      <view class="item-footer">
        <view class="cache-badge" wx:if="{{item.from_cache}}">
          <text>âš¡ ç¼“å­˜</text>
        </view>
        <view class="delete-btn" catchtap="onDelete" data-id="{{item._id}}" data-index="{{index}}">
          <text>åˆ é™¤</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½æ›´å¤š -->
  <view class="load-more" wx:if="{{hasMore && list.length > 0}}">
    <text wx:if="{{loading}}">åŠ è½½ä¸­...</text>
    <text wx:else>ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
  </view>

  <!-- æ²¡æœ‰æ›´å¤š -->
  <view class="no-more" wx:if="{{!hasMore && list.length > 0}}">
    <text>æ²¡æœ‰æ›´å¤šäº†</text>
  </view>

  <!-- è¿”å›é¦–é¡µ -->
  <view class="back-home" bindtap="onBackToHome" wx:if="{{list.length > 0}}">
    <text>è¿”å›é¦–é¡µ</text>
  </view>
</view>