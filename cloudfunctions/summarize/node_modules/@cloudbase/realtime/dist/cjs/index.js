"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.registerRealtime = void 0;
var websocket_client_1 = require("./websocket-client");
var common_1 = require("./common");
var hook = {
    target: 'database',
    entity: function () {
        var _a = this.platform, adapter = _a.adapter, runtime = _a.runtime;
        (0, common_1.setWsClass)(adapter.wsClass);
        (0, common_1.setRuntime)(runtime);
    },
};
var component = {
    name: 'realtime',
    IIFE: true,
    entity: function () {
        this.prototype.wsClientClass = websocket_client_1.RealtimeWebSocketClient;
    },
};
try {
    cloudbase.registerComponent(component);
    cloudbase.registerHook(hook);
}
catch (e) { }
function registerRealtime(app) {
    try {
        app.registerComponent(component);
        app.registerHook(hook);
    }
    catch (e) {
        console.warn(e);
    }
}
exports.registerRealtime = registerRealtime;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQ0EsdURBQTZEO0FBQzdELG1DQUFrRDtBQUtsRCxJQUFNLElBQUksR0FBbUI7SUFDM0IsTUFBTSxFQUFFLFVBQVU7SUFDbEIsTUFBTTtRQUNFLElBQUEsS0FBdUIsSUFBSSxDQUFDLFFBQVEsRUFBbEMsT0FBTyxhQUFBLEVBQUUsT0FBTyxhQUFrQixDQUFDO1FBQzNDLElBQUEsbUJBQVUsRUFBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7UUFDNUIsSUFBQSxtQkFBVSxFQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQ3RCLENBQUM7Q0FDRixDQUFDO0FBRUYsSUFBTSxTQUFTLEdBQXdCO0lBQ3JDLElBQUksRUFBRSxVQUFVO0lBQ2hCLElBQUksRUFBRSxJQUFJO0lBQ1YsTUFBTTtRQUNKLElBQUksQ0FBQyxTQUFTLENBQUMsYUFBYSxHQUFHLDBDQUF1QixDQUFDO0lBQ3pELENBQUM7Q0FDRixDQUFDO0FBRUYsSUFBSTtJQUNGLFNBQVMsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUN2QyxTQUFTLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxDQUFDO0NBQzlCO0FBQUMsT0FBTyxDQUFDLEVBQUUsR0FBRTtBQUVkLFNBQWdCLGdCQUFnQixDQUFDLEdBQXlEO0lBQ3hGLElBQUk7UUFDRixHQUFHLENBQUMsaUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDakMsR0FBRyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUN4QjtJQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ1YsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUNqQjtBQUNILENBQUM7QUFQRCw0Q0FPQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElDbG91ZGJhc2UgfSBmcm9tICdAY2xvdWRiYXNlL3R5cGVzJztcbmltcG9ydCB7IFJlYWx0aW1lV2ViU29ja2V0Q2xpZW50IH0gZnJvbSAnLi93ZWJzb2NrZXQtY2xpZW50JztcbmltcG9ydCB7IHNldFdzQ2xhc3MsIHNldFJ1bnRpbWUgfSBmcm9tICcuL2NvbW1vbic7XG5pbXBvcnQgeyBJQ2xvdWRiYXNlQ29tcG9uZW50LCBJQ2xvdWRiYXNlSG9vayB9IGZyb20gJ0BjbG91ZGJhc2UvdHlwZXMvY29tcG9uZW50JztcblxuZGVjbGFyZSBjb25zdCBjbG91ZGJhc2U6IElDbG91ZGJhc2U7XG5cbmNvbnN0IGhvb2s6IElDbG91ZGJhc2VIb29rID0ge1xuICB0YXJnZXQ6ICdkYXRhYmFzZScsXG4gIGVudGl0eSgpIHtcbiAgICBjb25zdCB7IGFkYXB0ZXIsIHJ1bnRpbWUgfSA9IHRoaXMucGxhdGZvcm07XG4gICAgc2V0V3NDbGFzcyhhZGFwdGVyLndzQ2xhc3MpO1xuICAgIHNldFJ1bnRpbWUocnVudGltZSk7XG4gIH0sXG59O1xuXG5jb25zdCBjb21wb25lbnQ6IElDbG91ZGJhc2VDb21wb25lbnQgPSB7XG4gIG5hbWU6ICdyZWFsdGltZScsXG4gIElJRkU6IHRydWUsXG4gIGVudGl0eSgpIHtcbiAgICB0aGlzLnByb3RvdHlwZS53c0NsaWVudENsYXNzID0gUmVhbHRpbWVXZWJTb2NrZXRDbGllbnQ7XG4gIH0sXG59O1xuXG50cnkge1xuICBjbG91ZGJhc2UucmVnaXN0ZXJDb21wb25lbnQoY29tcG9uZW50KTtcbiAgY2xvdWRiYXNlLnJlZ2lzdGVySG9vayhob29rKTtcbn0gY2F0Y2ggKGUpIHt9XG5cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlclJlYWx0aW1lKGFwcDogUGljazxJQ2xvdWRiYXNlLCAncmVnaXN0ZXJDb21wb25lbnQnfCdyZWdpc3Rlckhvb2snPikge1xuICB0cnkge1xuICAgIGFwcC5yZWdpc3RlckNvbXBvbmVudChjb21wb25lbnQpO1xuICAgIGFwcC5yZWdpc3Rlckhvb2soaG9vayk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBjb25zb2xlLndhcm4oZSk7XG4gIH1cbn1cbiJdfQ==